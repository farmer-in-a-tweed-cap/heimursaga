<%- include('includes/header') %>

<title>Heimursaga | Discovery</title>

<%- include('includes/sidebar') %>

<%- include('includes/navbar') %>


<main class="content" style="padding: 0rem !important;">

    <style>
        #overlay {
        position: absolute; /* Sit on top of the page content */
        /* display: none;  Hidden by default */
        width: 100%; /* Full width (cover the whole page) */
        height: 100%; /* Full height (cover the whole page) */ 
        background-color: rgb(244, 247, 252, 0.7); /* Black background with opacity */
        z-index: 3; /* Specify a stack order in case you're using a different order for other elements */
        }

        .mapboxgl-popup {
        max-width: 400px;
       font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
        }

        .start-geocoder {
        position: absolute;
        z-index: 2;
        width: 50%;
        left: 50%;
        margin-left: -25%;
        top: 120px;
        }
        .mapboxgl-ctrl-geocoder {
        min-width: 100%;
        }
    </style>

        <div class="container-fluid p-0" style="position: relative;">

                <div class="col-12" style="padding: 0rem; "class="overlay" id="overlay">
                    <div class="text-center" style="margin-top: 40px;">
                        <h3>Your Journey Begins Here...</h3>
                        <small>Search for a place to read journal entries in that area</small>
                    </div>
                    <div id="start-geocoder" class="start-geocoder"></div>
                </div>

            <div style="padding: 2.5rem 2.5rem 1.5rem !important;">
                <div class="row">
                    <h3 class="text-center d-lg-none pb-3">Discovery</h3>

                    <%- include('includes/flash') %>

                    <div class="col-12 col-lg-8 d-flex">
                        <div id="map-div" class="card w-100" style="height: 80vh;">
                            <div class="card d-flex w-100"">
                                    <style>
 

                                    </style>
                                    
                                    <input type="hidden" name="_csrf" value="<%= csrfToken %>">

                                    <div id="map" class="map" style='width: 100%; height: 80vh;'></div>
                                    
                            </div>
                        </div>
                    </div>

                    <div class="col-12 col-lg-4 d-flex">
                        <div id="entry-div" class="card flex-fill" style="height: 80vh;">
                            <div class="card-body overflow-auto">
                                <div class="list-group list-group-flush">

                                    <input type="hidden" name="_csrf" value="<%= csrfToken %>">

                                    <div id="dynamic-entry-feed" class="dynamic-entry-feed" style='height: 80vh;'></div>
                                    

                                </div>
                            </div>
                        </div>
                    </div>
                    
                </div>
            </div>
        </div>

</main>


<script type="text/javascript">

    var overlay = document.getElementById("overlay");
    var feed = document.getElementById("entry-div")
    var mapdiv = document.getElementById("map-div")

    if (overlay.style.display != "none") {
        feed.style.display = "none"
        //mapdiv.style.display = "none"
    } 

    function convertToPlain(html){
        var tempDivElement = document.createElement('entrymarkers');
        tempDivElement.innerHTML = html;
        return tempDivElement.textContent || tempDivElement.innerText || '';
    }

    var htmlString= '<entrymarkers><%= entrymarker %></entrymarkers>';

    var markers = (convertToPlain(htmlString))

</script>
			
<%- include('includes/footer') %>